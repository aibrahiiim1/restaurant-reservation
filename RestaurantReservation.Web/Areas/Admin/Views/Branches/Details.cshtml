@model Branch
@{
    ViewData["Title"] = Model.Name;
}

<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
    <h1 class="h2">
        @if (!string.IsNullOrEmpty(Model.LogoUrl))
        {
            <img src="@Model.LogoUrl" alt="@Model.Name" class="rounded me-2" style="width: 40px; height: 40px; object-fit: cover;">
        }
        @Model.Name
    </h1>
    <div class="btn-group">
        <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary">
            <i class="bi bi-pencil me-1"></i>Edit
        </a>
        <a asp-action="Index" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left me-1"></i>Back to List
        </a>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <!-- Basic Info -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-info-circle me-2"></i>Branch Details</h5>
            </div>
            <div class="card-body">
                <dl class="row mb-0">
                    <dt class="col-sm-3">Restaurant</dt>
                    <dd class="col-sm-9">@Model.Restaurant?.Name</dd>
                    
                    <dt class="col-sm-3">Name</dt>
                    <dd class="col-sm-9">@Model.Name</dd>
                    
                    <dt class="col-sm-3">Description</dt>
                    <dd class="col-sm-9">@(Model.Description ?? "—")</dd>
                    
                    <dt class="col-sm-3">Cuisine</dt>
                    <dd class="col-sm-9">@(Model.Cuisine ?? "—")</dd>
                    
                    <dt class="col-sm-3">Status</dt>
                    <dd class="col-sm-9">
                        @if (Model.IsActive)
                        {
                            <span class="badge bg-success">Active</span>
                        }
                        else
                        {
                            <span class="badge bg-secondary">Inactive</span>
                        }
                    </dd>
                </dl>
            </div>
        </div>
        
        <!-- Location -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-geo-alt me-2"></i>Location</h5>
            </div>
            <div class="card-body">
                <dl class="row mb-0">
                    <dt class="col-sm-3">Address</dt>
                    <dd class="col-sm-9">
                        @Model.Address<br>
                        @if (!string.IsNullOrEmpty(Model.City))
                        {
                            @Model.City@(string.IsNullOrEmpty(Model.State) ? "" : $", {Model.State}") @Model.ZipCode
                        }
                        @if (!string.IsNullOrEmpty(Model.Country))
                        {
                            <br>@Model.Country
                        }
                    </dd>
                    
                    @if (Model.Latitude.HasValue && Model.Longitude.HasValue)
                    {
                        <dt class="col-sm-3">Coordinates</dt>
                        <dd class="col-sm-9">
                            <a href="https://maps.google.com/?q=@Model.Latitude,@Model.Longitude" target="_blank">
                                @Model.Latitude, @Model.Longitude <i class="bi bi-box-arrow-up-right"></i>
                            </a>
                        </dd>
                    }
                </dl>
            </div>
        </div>
        
        <!-- Contact -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-telephone me-2"></i>Contact</h5>
            </div>
            <div class="card-body">
                <dl class="row mb-0">
                    <dt class="col-sm-3">Phone</dt>
                    <dd class="col-sm-9">
                        @if (!string.IsNullOrEmpty(Model.Phone))
                        {
                            <a href="tel:@Model.Phone">@Model.Phone</a>
                        }
                        else
                        {
                            <text>—</text>
                        }
                    </dd>
                    
                    <dt class="col-sm-3">Email</dt>
                    <dd class="col-sm-9">
                        @if (!string.IsNullOrEmpty(Model.Email))
                        {
                            <a href="mailto:@Model.Email">@Model.Email</a>
                        }
                        else
                        {
                            <text>—</text>
                        }
                    </dd>
                    
                    <dt class="col-sm-3">Website</dt>
                    <dd class="col-sm-9">
                        @if (!string.IsNullOrEmpty(Model.Website))
                        {
                            <a href="@Model.Website" target="_blank">@Model.Website <i class="bi bi-box-arrow-up-right"></i></a>
                        }
                        else
                        {
                            <text>—</text>
                        }
                    </dd>
                </dl>
            </div>
        </div>
        
        <!-- Tables -->
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="bi bi-grid-3x3 me-2"></i>Tables (@Model.Tables.Count)</h5>
                <a asp-controller="Tables" asp-action="Create" asp-route-branchId="@Model.Id" class="btn btn-sm btn-primary">
                    <i class="bi bi-plus-lg me-1"></i>Add Table
                </a>
            </div>
            <div class="card-body p-0">
                @if (Model.Tables.Any())
                {
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th>Table #</th>
                                    <th>Capacity</th>
                                    <th>Location</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var table in Model.Tables.OrderBy(t => t.TableNumber))
                                {
                                    <tr>
                                        <td>@table.TableNumber</td>
                                        <td>@table.MinCapacity - @table.MaxCapacity</td>
                                        <td>@table.LocationType</td>
                                        <td>
                                            @if (table.IsActive)
                                            {
                                                <span class="badge bg-success">Active</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-secondary">Inactive</span>
                                            }
                                        </td>
                                        <td>
                                            <a asp-controller="Tables" asp-action="Edit" asp-route-id="@table.Id" class="btn btn-sm btn-outline-primary">
                                                <i class="bi bi-pencil"></i>
                                            </a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                }
                else
                {
                    <div class="text-center py-4">
                        <i class="bi bi-grid-3x3 fs-1 text-muted"></i>
                        <p class="mt-2 text-muted">No tables yet</p>
                        <a asp-controller="Tables" asp-action="Create" asp-route-branchId="@Model.Id" class="btn btn-primary">
                            <i class="bi bi-plus-lg me-1"></i>Add First Table
                        </a>
                    </div>
                }
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <!-- Features -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-stars me-2"></i>Features</h5>
            </div>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item d-flex justify-content-between align-items-center px-0">
                        Parking
                        @if (Model.HasParking)
                        {
                            <i class="bi bi-check-circle-fill text-success"></i>
                        }
                        else
                        {
                            <i class="bi bi-x-circle text-muted"></i>
                        }
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center px-0">
                        Wheelchair Accessible
                        @if (Model.IsAccessible)
                        {
                            <i class="bi bi-check-circle-fill text-success"></i>
                        }
                        else
                        {
                            <i class="bi bi-x-circle text-muted"></i>
                        }
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center px-0">
                        Child Friendly
                        @if (Model.IsChildFriendly)
                        {
                            <i class="bi bi-check-circle-fill text-success"></i>
                        }
                        else
                        {
                            <i class="bi bi-x-circle text-muted"></i>
                        }
                    </li>
                </ul>
                
                <hr>
                
                <dl class="row mb-0">
                    <dt class="col-6">Dress Code</dt>
                    <dd class="col-6">@(Model.DressCode ?? "—")</dd>
                    
                    <dt class="col-6">Payment</dt>
                    <dd class="col-6">@(Model.PaymentOptions ?? "—")</dd>
                    
                    <dt class="col-6">Area</dt>
                    <dd class="col-6">@(Model.Area ?? "—")</dd>
                </dl>
            </div>
        </div>
        
        <!-- Booking Settings -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-calendar-check me-2"></i>Booking Settings</h5>
            </div>
            <div class="card-body">
                <dl class="row mb-0">
                    <dt class="col-7">Capacity</dt>
                    <dd class="col-5">@Model.Capacity guests</dd>
                    
                    <dt class="col-7">Interval</dt>
                    <dd class="col-5">@Model.BookingIntervalMinutes min</dd>
                    
                    <dt class="col-7">Cancellation</dt>
                    <dd class="col-5">@Model.CancellationPolicyHours hrs</dd>
                    
                    <dt class="col-7">Min Charge</dt>
                    <dd class="col-5">@(Model.MinimumCharge?.ToString("C") ?? "—")</dd>
                    
                    <dt class="col-7">Deposit</dt>
                    <dd class="col-5">
                        @if (Model.RequireDeposit)
                        {
                            @(Model.DepositAmount?.ToString("C") ?? "Required")
                        }
                        else
                        {
                            <text>Not required</text>
                        }
                    </dd>
                </dl>
            </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Quick Actions</h5>
                <div class="d-grid gap-2">
                    <a asp-controller="Tables" asp-action="Index" asp-route-branchId="@Model.Id" class="btn btn-outline-primary">
                        <i class="bi bi-grid-3x3 me-1"></i>Manage Tables
                    </a>
                    <a asp-controller="Bookings" asp-action="Index" asp-route-branchId="@Model.Id" class="btn btn-outline-info">
                        <i class="bi bi-calendar-check me-1"></i>View Bookings
                    </a>
                    <a asp-controller="Bookings" asp-action="Calendar" asp-route-branchId="@Model.Id" class="btn btn-outline-secondary">
                        <i class="bi bi-calendar3 me-1"></i>Calendar View
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
